{"version":3,"file":"commonHelpers.js","sources":["../src/js/fetch-data.js","../src/js/create-markup.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = `29304756-51da1fab5abbfa991ea2eaa1b`; \n\nasync function fetchData(textQuery, page, perPage) {\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: textQuery,\n        image_type:'photo', \n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: perPage,   \n    }); \n\n    const response = await axios.get(`${BASE_URL}?${params}`);\n\n    return response;   \n} \n\nexport { fetchData };\n\n","export function createMarkup(images) {\n    const gallery = document.querySelector('.gallery');\n        const markupGallery = images.map(({ webformatURL, tags, likes, views, comments, downloads, largeImageURL }) =>\n            {return `<div class=\"photo-card\">\n                <a href = \"${largeImageURL}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                <div class=\"info\">\n                    <p class=\"info-item\"><b>Likes:</b>${likes}</p>\n                    <p class=\"info-item\"><b>Views:</b>${views}</p>\n                    <p class=\"info-item\"><b>Comments:</b>${comments}</p>\n                    <p class=\"info-item\"><b>Downloads:</b>${downloads}</p>\n                </div> \n                </a>\n            </div>`\n    })\n        .join(''); \n    gallery.insertAdjacentHTML('beforeend', markupGallery);\n}   ","import { fetchData } from './js/fetch-data';\nimport { createMarkup } from './js/create-markup';\nimport SimpleLightbox from \"simplelightbox\";\nimport iziToast from 'izitoast'; \nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport 'izitoast/dist/css/iziToast.css'; \n\nconst refs = {\n    searchForm: document.querySelector('#search-form'),\n    gallery: document.querySelector('.gallery'),\n    imageGallery: document.querySelector('photo-card'),\n    submitBtn: document.querySelector('.submit-btn'),\n    guard: document.querySelector('.js-guard'),\n    loader: document.querySelector('.loader'),\n}\n\nconst options = {\n    rootMargin: '300px',\n    threshold: 0.5,\n};\n\nlet page = 1;\nconst perPage = 40;\n\nlet textQuery = '';\nlet isObserving = false;\n\nconst observer = new IntersectionObserver(onIntersection, options);\n\nrefs.submitBtn.disabled = true;\n\nrefs.searchForm.addEventListener('submit', onSearchForm);\nrefs.searchForm.addEventListener('input', (e) => e.target.value ? refs.submitBtn.disabled = false : refs.submitBtn.disabled = true);\n\nrefs.loader.classList.add('hidden');\n\nfunction onIntersection(entries, observer) {\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            page += 1;\n\n            fetchData(textQuery, page, perPage)\n                .then(({ data }) => {\n                    if (!data.hits || data.hits.length === 0) {\n                    return;\n                    } \n                    \n                    if (data.hits.length > 0) {\n                        createMarkup(data.hits);\n                        onSimpleLightbox();\n                        } else {\n                        observer.unobserve(entry.target);\n                    }\n                })\n                .catch(error => {\n                    console.error(error);\n\n                    iziToast.error({\n                        title: 'Server error',\n                        message: 'Oops! Something went wrong! Try reloading the page!',\n                        position: 'center',\n                    });\n                });\n        }\n    });\n}\n\nfunction observeLastElement() {\n    const lastElement = refs.gallery.lastElementChild;\n    if (lastElement && !isObserving) {\n        observer.observe(lastElement);\n        isObserving = true;\n    }\n}\n\nfunction onSearchForm(e) {\n    e.preventDefault();\n\n    page = 1;\n    textQuery = e.currentTarget.searchQuery.value.trim();\n\n    refs.gallery.innerHTML = '';\n\n    if (/\\d/.test(textQuery)) {\n        return iziToast.error({\n            title: 'Error',\n            message: `Sorry, you can only use letters to search`,\n            position: 'center',\n        });\n    }\n\n    fetchData(textQuery, page, perPage)\n        .then(({ data }) => {\n            refs.loader.classList.remove('hidden');\n\n            if (data.totalHits === 0) {\n                iziToast.error({\n                    title: 'Error',\n                    message: `Sorry, there are no images matching your search query. Please try again.`,\n                    position: 'center',\n                });\n            } else {\n\n            if (!data.hits || data.hits.length === 0) {\n                    return;\n            } else {\n                refs.loader.classList.add('hidden');\n\n                createMarkup(data.hits);\n                onSimpleLightbox(); \n                observeLastElement();\n                } \n\n                iziToast.info({\n                    title: 'Information',\n                    message: `Hooray! We found ${data.totalHits} images.`,\n                    position: 'center',\n                });\n            }\n        })\n        .catch(error => {\n            console.error(error);\n            refs.loader.classList.add('hidden');\n            \n            iziToast.error({\n                title: 'Server error',\n                message: 'Oops! Something went wrong! Try reloading the page!',\n                position: 'center',\n            })\n        });\n}\n\nobserveLastElement();\n\nfunction onSimpleLightbox() {\n    new SimpleLightbox('.gallery a').refresh();\n}\n\n\n\n"],"names":["BASE_URL","API_KEY","fetchData","textQuery","page","perPage","params","axios","createMarkup","images","gallery","markupGallery","webformatURL","tags","likes","views","comments","downloads","largeImageURL","refs","options","isObserving","observer","onIntersection","onSearchForm","e","entries","entry","data","onSimpleLightbox","error","iziToast","observeLastElement","lastElement","SimpleLightbox"],"mappings":"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"}